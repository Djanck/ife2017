!function(t,e){if("function"==typeof define&&define.amd)define(["exports"],e);else if("undefined"!=typeof exports)e(exports);else{var i={exports:{}};e(i.exports),t.index=i.exports}}(this,function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),s={bgColor:["#f3f3f3","#dfdfdf"],snakeColor:"#2980b9",barrierColor:"#333",appleColor:"#d71345",appleScore:100,cardinalNumber:10,startCb:null,stopCb:null,pauseBegin:null,pauseEnd:null},r={rows:20,cols:20,size:30,barrier:[],dir:"right",body:[0,1,2,3,4],speed:150},n={normal:{rows:20,cols:20,size:30,mode:{speedUp:{time:2e4,count:5},eatApple:null}},custom:{rows:20,cols:20,size:30,mode:{speedUp:null,eatApple:{cur:0,pass:5,count:5}}},elude:{rows:20,cols:20,size:30,mode:{speedUp:null,eatApple:{cur:0,pass:10,custom:!0}}}},a={left:"right",right:"left",top:"bottom",bottom:"top"},h=function(){function t(i,n){e(this,t),Object.assign(this,s,r,n),this.canvas=document.getElementById(i),this.parent=this.canvas.parentElement,this.cxt=this.canvas.getContext("2d"),this.init()}return i(t,[{key:"init",value:function(){this.isAnimate=!1,this.isPlaying=!1,this.custom=1,this.score=0,this.events=[],this.createStaticCanvas(),this.createStat(),this.setSize(),this.getMaps(),this.bindEvent(),this.render()}},{key:"createStaticCanvas",value:function(){this.static_canvas=document.createElement("canvas"),this.static_cxt=this.static_canvas.getContext("2d"),this.canvas.style.cssText="\n            position: relative;\n            z-index: 1;\n        ",this.static_canvas.style.cssText="\n            position: absolute;\n            left: 0;\n            top: 0;\n        ",this.parent.style.position="relative",this.parent.appendChild(this.static_canvas)}},{key:"createStat",value:function(){var t=this;this.stat=document.createElement("DIV"),this.speedBlock=document.createElement("DIV"),this.scoreBlock=document.createElement("DIV"),this.stat.style.cssText="\n            position: absolute;\n            right: 0;\n            bottom: 100%;\n            font-size: 16px;\n        ",this.observer("speed",function(e){return t.speedBlock.textContent="速度："+e+"ms/格"}),this.observer("score",function(e){return t.scoreBlock.textContent="得分："+e}),this.stat.appendChild(this.speedBlock),this.stat.appendChild(this.scoreBlock),this.parent.appendChild(this.stat)}},{key:"observer",value:function(t,e){var i=this[t];Object.defineProperty(this,t,{get:function(){return i},set:function(t){e(t),i=t},enumerable:!0,configurable:!0})}},{key:"setSize",value:function(){this.width=this.cols*this.size,this.height=this.rows*this.size,this.canvas.width=this.width,this.canvas.height=this.height,this.static_canvas.width=this.width,this.static_canvas.height=this.height}},{key:"getMaps",value:function(){this.maps={top:-this.cols,bottom:this.cols,left:-1,right:1}}},{key:"bindEvent",value:function(){document.addEventListener("keydown",this.getKeyCode.bind(this))}},{key:"getKeyCode",value:function(t){var e=this;switch(t.keyCode){case 87:case 38:this.events.push(function(){return e.setDir("top")});break;case 65:case 37:this.events.push(function(){return e.setDir("left")});break;case 39:case 68:this.events.push(function(){return e.setDir("right")});break;case 40:case 83:this.events.push(function(){return e.setDir("bottom")});break;case 32:return this.switchGameStatus();default:return!1}}},{key:"execQueue",value:function(){this.events.length&&this.events.shift()()}},{key:"start",value:function(t){Object.assign(this,r,n[t]),this.dir="right",this.barrier=[],this.events=[],"elude"===t&&this.createBarrier(),this.score="elude"===t?(this.custom-1)*this.mode.eatApple.pass*this.appleScore:0,this.startCb&&this.startCb(),this.gameRest(),this.gameTime=0,this.gameStart()}},{key:"createBarrier",value:function(){for(var t=0;t<this.custom*this.cardinalNumber;t++){for(var e=this.body[0];e<=this.cols;)e=this.getRandom();this.barrier.push(e)}}},{key:"gameRest",value:function(){this.setSize(),this.getMaps(),this.renderBg(),this.renderBarrier(),this.renderGrid(),this.addApple()}},{key:"gameStart",value:function(){var t=this;this.isAnimate=!0;var e=function i(){setTimeout(function(){return!!t.isAnimate&&(t.gameTime+=t.speed,t.mode.speedUp&&t.gameTime>=t.mode.speedUp.time&&(t.gameTime=0,t.speed-=t.mode.speedUp.count),t.cxt.clearRect(0,0,t.width,t.height),t.execQueue(),t.update(),t.render(),void i())},t.speed)};e()}},{key:"stop",value:function(){this.stopCb&&this.stopCb(),this.isAnimate=!1}},{key:"switchGameStatus",value:function(){return!!this.isPlaying&&void(this.isAnimate?(this.pauseBegin&&this.pauseBegin(),this.isAnimate=!1):(this.pauseEnd&&this.pauseEnd(),this.gameStart()))}},{key:"gameover",value:function(){this.stop(),this.render()}},{key:"render",value:function(){this.renderSnake(),this.renderApple()}},{key:"renderBarrier",value:function(){var t=this;this.static_cxt.fillStyle=this.barrierColor,Array.from(this.barrier,function(e,i){var s=t.getCoord(e),r=s.x,n=s.y;t.static_cxt.fillRect(r*t.size,n*t.size,t.size,t.size)})}},{key:"renderSnake",value:function(){var t=this;this.cxt.fillStyle=this.snakeColor,Array.from(this.body,function(e,i){var s=t.getCoord(e),r=s.x,n=s.y;t.cxt.fillRect(r*t.size,n*t.size,t.size,t.size)})}},{key:"renderGrid",value:function(){this.static_cxt.strokeStyle="#ccc",this.static_cxt.lineWidth=1;for(var t=0;t<this.rows;t++)this.static_cxt.moveTo(t*this.size,0),this.static_cxt.lineTo(t*this.size,this.rows*this.size),this.static_cxt.stroke();for(var e=0;e<this.cols;e++)this.static_cxt.moveTo(0,e*this.size),this.static_cxt.lineTo(this.cols*this.size,e*this.size),this.static_cxt.stroke()}},{key:"renderBg",value:function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.cols;e++)this.static_cxt.fillStyle=(t+e)%2===0?this.bgColor[0]:this.bgColor[1],this.static_cxt.fillRect(t*this.size,e*this.size,this.width,this.height)}},{key:"renderApple",value:function(){if(this.apple){var t=this.getCoord(this.apple),e=t.x,i=t.y;this.cxt.fillStyle=this.appleColor,this.cxt.beginPath(),this.cxt.arc(e*this.size+this.size/2,i*this.size+this.size/2,this.size/2,0,2*Math.PI,!0),this.cxt.closePath(),this.cxt.fill()}else this.addApple(),this.renderApple()}},{key:"getCoord",value:function(t){return{x:t%this.cols,y:~~(t/this.cols)}}},{key:"setDir",value:function(t){return t!==this.dir&&t!==a[this.dir]&&void(this.dir=t)}},{key:"isFailed",value:function(t){var e=this.getCoord(t),i=e.x,s=e.y;return 0===i&&"left"===this.dir?(this.gameover(),!0):i===this.cols-1&&"right"===this.dir?(this.gameover(),!0):0===s&&"top"===this.dir?(this.gameover(),!0):s===this.rows-1&&"bottom"===this.dir?(this.gameover(),!0):void 0}},{key:"getSelfDir",value:function(t,e){var i=e-t;for(var s in this.maps)if(i===this.maps[s])return s}},{key:"update",value:function(){var t=this,e=this.body,i=this.barrier,s=e[e.length-1],r=e[0],n=s+this.maps[this.dir];if(this.isFailed(s)||e.indexOf(n)>-1||i.indexOf(n)>-1)return this.gameover();if(this.body=Array.from(this.body,function(i,s){return s===e.length-1?n:i+t.maps[t.getSelfDir(i,e[s+1])]}),n===this.apple&&(this.apple=null,this.score+=this.appleScore,this.body.unshift(r),this.mode.eatApple&&(this.mode.eatApple.cur++,this.mode.eatApple.cur===this.mode.eatApple.pass))){if(this.mode.eatApple.cur=0,this.mode.eatApple.custom)return this.custom++,this.gameover(),setTimeout(function(){return alert("你通关了，继续玩躲避模式进行下一关")}),!1;this.speed-=this.mode.eatApple.count}}},{key:"getRandom",value:function(){return~~(Math.random()*this.cols*this.rows)}},{key:"addApple",value:function(){for(var t=this.getRandom();this.body.indexOf(t)>-1||this.barrier.indexOf(t)>-1;)t=this.getRandom();this.apple=t}}]),t}();t["default"]=h});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImphdmFzY3JpcHRzL1NuYWtlL2luZGV4LmpzIl0sIm5hbWVzIjpbImdsb2JhbCIsImZhY3RvcnkiLCJkZWZpbmUiLCJhbWQiLCJleHBvcnRzIiwibW9kIiwiaW5kZXgiLCJ0aGlzIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwidmFsdWUiLCJfY3JlYXRlQ2xhc3MiLCJkZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJpIiwibGVuZ3RoIiwiZGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsImtleSIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsInByb3RvdHlwZSIsIl9kZWZhdWx0IiwiYmdDb2xvciIsInNuYWtlQ29sb3IiLCJiYXJyaWVyQ29sb3IiLCJhcHBsZUNvbG9yIiwiYXBwbGVTY29yZSIsImNhcmRpbmFsTnVtYmVyIiwic3RhcnRDYiIsInN0b3BDYiIsInBhdXNlQmVnaW4iLCJwYXVzZUVuZCIsIl9pbml0Iiwicm93cyIsImNvbHMiLCJzaXplIiwiYmFycmllciIsImRpciIsImJvZHkiLCJzcGVlZCIsIl9tb2RlIiwibm9ybWFsIiwibW9kZSIsInNwZWVkVXAiLCJ0aW1lIiwiY291bnQiLCJlYXRBcHBsZSIsImN1c3RvbSIsImN1ciIsInBhc3MiLCJlbHVkZSIsImRpck1hcCIsImxlZnQiLCJyaWdodCIsInRvcCIsImJvdHRvbSIsIlNuYWtlIiwiaWQiLCJvcHRpb24iLCJhc3NpZ24iLCJjYW52YXMiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwicGFyZW50IiwicGFyZW50RWxlbWVudCIsImN4dCIsImdldENvbnRleHQiLCJpbml0IiwiaXNBbmltYXRlIiwiaXNQbGF5aW5nIiwic2NvcmUiLCJldmVudHMiLCJjcmVhdGVTdGF0aWNDYW52YXMiLCJjcmVhdGVTdGF0Iiwic2V0U2l6ZSIsImdldE1hcHMiLCJiaW5kRXZlbnQiLCJyZW5kZXIiLCJzdGF0aWNfY2FudmFzIiwiY3JlYXRlRWxlbWVudCIsInN0YXRpY19jeHQiLCJzdHlsZSIsImNzc1RleHQiLCJwb3NpdGlvbiIsImFwcGVuZENoaWxkIiwiX3RoaXMiLCJzdGF0Iiwic3BlZWRCbG9jayIsInNjb3JlQmxvY2siLCJvYnNlcnZlciIsInZhbCIsInRleHRDb250ZW50IiwiY2IiLCJnZXQiLCJzZXQiLCJuZXdWYWx1ZSIsIndpZHRoIiwiaGVpZ2h0IiwibWFwcyIsImFkZEV2ZW50TGlzdGVuZXIiLCJnZXRLZXlDb2RlIiwiYmluZCIsImUiLCJfdGhpczIiLCJrZXlDb2RlIiwicHVzaCIsInNldERpciIsInN3aXRjaEdhbWVTdGF0dXMiLCJzaGlmdCIsImNyZWF0ZUJhcnJpZXIiLCJnYW1lUmVzdCIsImdhbWVUaW1lIiwiZ2FtZVN0YXJ0IiwiZ2V0UmFuZG9tIiwicmVuZGVyQmciLCJyZW5kZXJCYXJyaWVyIiwicmVuZGVyR3JpZCIsImFkZEFwcGxlIiwiX3RoaXMzIiwidGltZXIiLCJzZXRUaW1lb3V0IiwiY2xlYXJSZWN0IiwiZXhlY1F1ZXVlIiwidXBkYXRlIiwic3RvcCIsInJlbmRlclNuYWtlIiwicmVuZGVyQXBwbGUiLCJfdGhpczQiLCJmaWxsU3R5bGUiLCJBcnJheSIsImZyb20iLCJwb3MiLCJfZ2V0Q29vcmQiLCJnZXRDb29yZCIsIngiLCJ5IiwiZmlsbFJlY3QiLCJfdGhpczUiLCJfZ2V0Q29vcmQyIiwic3Ryb2tlU3R5bGUiLCJsaW5lV2lkdGgiLCJtb3ZlVG8iLCJsaW5lVG8iLCJzdHJva2UiLCJhcHBsZSIsIl9nZXRDb29yZDMiLCJiZWdpblBhdGgiLCJhcmMiLCJNYXRoIiwiUEkiLCJjbG9zZVBhdGgiLCJmaWxsIiwiX2dldENvb3JkNCIsImdhbWVvdmVyIiwicG9zMSIsInBvczIiLCJkIiwiX3RoaXM2IiwiaGVhZCIsInRhaWwiLCJuZXh0SGVhZCIsImlzRmFpbGVkIiwiaW5kZXhPZiIsImdldFNlbGZE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LEtBQUs0SCxRQUFRbEIsT0FBZWpKLEtBQUtxQyxRQUFROEgsUUFBUWxCLE9BQ3pEQSxFQUFRakosS0FBS2tILFdBRWpCbEgsTUFBS2lKLE1BQVFBLE1BNEdOeEYsSUFHWDVELEdBQUFBLFdBL2RpQjREIiwiZmlsZSI6ImphdmFzY3JpcHRzL1NuYWtlL2luZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnXHJcblxyXG4vLyAg6buY6K6k6YWN572uXHJcbmNvbnN0IF9kZWZhdWx0ID0ge1xyXG4gICAgYmdDb2xvcjogWycjZjNmM2YzJywgJyNkZmRmZGYnXSxcclxuICAgIHNuYWtlQ29sb3I6ICcjMjk4MGI5JywgIC8vICDom4fpopzoibJcclxuICAgIGJhcnJpZXJDb2xvcjogJyMzMzMnLCAgIC8vICDpmpznoo3nianpopzoibJcclxuICAgIGFwcGxlQ29sb3I6ICcjZDcxMzQ1JywgIC8vICDmnpzlrZDpopzoibJcclxuICAgIGFwcGxlU2NvcmU6IDEwMCwgICAgICAgIC8vICDmnpzlrZDliIbmlbBcclxuICAgIGNhcmRpbmFsTnVtYmVyOiAxMCwgICAgIC8vICDourLpgb/mqKHlvI/pmpznoo3nianmlbDph4/ln7rmlbBcclxuICAgIHN0YXJ0Q2I6IG51bGwsICAgICAgICAgIC8vICDmuLjmiI/lvIDlp4vlm57osINcclxuICAgIHN0b3BDYjogbnVsbCwgICAgICAgICAgIC8vICDmuLjmiI/nu5PmnZ/lm57osINcclxuICAgIHBhdXNlQmVnaW46IG51bGwsICAgICAgIC8vICDmuLjmiI/mmoLlgZzlm57osINcclxuICAgIHBhdXNlRW5kOiBudWxsICAgICAgICAgIC8vICDmuLjmiI/nu6fnu63lm57osINcclxufVxyXG5cclxuLy8gIOWIneWni+WMlua4uOaIj+aVsOaNrlxyXG5jb25zdCBfaW5pdCA9IHtcclxuICAgIHJvd3M6IDIwLCAvLyAg6KGM5pWwXHJcbiAgICBjb2xzOiAyMCwgLy8gIOWIl+aVsFxyXG4gICAgc2l6ZTogMzAsIC8vICDmr4/kuIDlnZfnmoTlpKflsI9cclxuICAgIGJhcnJpZXI6IFtdLCAgLy8gIOmanOeijeeJqeaVsOe7hFxyXG4gICAgZGlyOiAncmlnaHQnLCAgLy8gIOi1t+Wni+aWueWQkVxyXG4gICAgYm9keTogWzAsIDEsIDIsIDMsIDRdLCAgLy8g6LW35aeL6JuH6LqrXHJcbiAgICBzcGVlZDogMTUwICAgLy8gIOm7mOiupOi1t+Wni+mAn+W6pnvmr6vnp5J9XHJcbn1cclxuXHJcbi8vICDlhbPljaHphY3nva7lr7nosaFcclxuY29uc3QgX21vZGUgPSB7XHJcbiAgICBub3JtYWw6IHtcclxuICAgICAgICByb3dzOiAyMCxcclxuICAgICAgICBjb2xzOiAyMCxcclxuICAgICAgICBzaXplOiAzMCxcclxuICAgICAgICBtb2RlOiB7XHJcbiAgICAgICAgICAgIHNwZWVkVXA6IHsgICAgICAgIC8vICDlpJrkuYXlkI7liqDpgJ9cclxuICAgICAgICAgICAgICAgIHRpbWU6IDIwMDAwLCAgLy8gIDIw56eS5Yqg6YCf5LiA5qyhXHJcbiAgICAgICAgICAgICAgICBjb3VudDogNSAgICAgIC8vICDkuIDmrKHlv6s15q+r56eSXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVhdEFwcGxlOiBudWxsXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGN1c3RvbToge1xyXG4gICAgICAgIHJvd3M6IDIwLFxyXG4gICAgICAgIGNvbHM6IDIwLFxyXG4gICAgICAgIHNpemU6IDMwLFxyXG4gICAgICAgIG1vZGU6IHtcclxuICAgICAgICAgICAgc3BlZWRVcDogbnVsbCxcclxuICAgICAgICAgICAgZWF0QXBwbGU6IHtcclxuICAgICAgICAgICAgICAgIGN1cjogMCwgICAgLy8gIOW9k+WJjeWQg+S6huWHoOS4qlxyXG4gICAgICAgICAgICAgICAgcGFzczogNSwgICAvLyAg5ZCD5LqU5Liq6Iu55p6c5Yqg5LiA57qnXHJcbiAgICAgICAgICAgICAgICBjb3VudDogNSAgIC8vICDkuIDnuqflv6s15q+r56eSXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgZWx1ZGU6IHtcclxuICAgICAgICByb3dzOiAyMCxcclxuICAgICAgICBjb2xzOiAyMCxcclxuICAgICAgICBzaXplOiAzMCxcclxuICAgICAgICBtb2RlOiB7XHJcbiAgICAgICAgICAgIHNwZWVkVXA6IG51bGwsXHJcbiAgICAgICAgICAgIGVhdEFwcGxlOiB7XHJcbiAgICAgICAgICAgICAgICBjdXI6IDAsICAgICAgIC8vICDlvZPliY3lkIPkuoblh6DkuKpcclxuICAgICAgICAgICAgICAgIHBhc3M6IDEwLCAgICAgLy8gIOWQg+WNgeS4quiLueaenOi/m+WFpeS4i+S4gOWFs1xyXG4gICAgICAgICAgICAgICAgY3VzdG9tOiB0cnVlICAvLyAg5YWz5Y2h5qih5byPXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vICDlr7nnq4vmlrnlkJHlr7nosaFcclxuY29uc3QgZGlyTWFwID0ge1xyXG4gICAgbGVmdDogJ3JpZ2h0JyxcclxuICAgIHJpZ2h0OiAnbGVmdCcsXHJcbiAgICB0b3A6ICdib3R0b20nLFxyXG4gICAgYm90dG9tOiAndG9wJ1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTbmFrZSB7XHJcbiAgICBjb25zdHJ1Y3RvcihpZCwgb3B0aW9uKSB7XHJcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLCBfZGVmYXVsdCwgX2luaXQsIG9wdGlvbilcclxuICAgICAgICB0aGlzLmNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKVxyXG4gICAgICAgIHRoaXMucGFyZW50ID0gdGhpcy5jYW52YXMucGFyZW50RWxlbWVudFxyXG4gICAgICAgIHRoaXMuY3h0ID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgnMmQnKVxyXG4gICAgICAgIHRoaXMuaW5pdCgpXHJcbiAgICB9XHJcbiAgICAvLyAg5ri45oiP5Yid5aeL5YyWXHJcbiAgICBpbml0KCkge1xyXG4gICAgICAgIHRoaXMuaXNBbmltYXRlID0gZmFsc2UgIC8vICDmmK/lkKbmuLjmiI/kuK1cclxuICAgICAgICB0aGlzLmlzUGxheWluZyA9IGZhbHNlICAvLyAg5piv5ZCm5bey57uP5byA5aeL5ri45oiP77yI5bCx566X5pqC5YGc5Lmf5pivdHJ1Ze+8iVxyXG4gICAgICAgIHRoaXMuY3VzdG9tID0gMSAgICAgLy8gIOW9k+WJjeWFs+WNoe+8jOi6sumBv+aooeW8j+eUqOeahCBcclxuICAgICAgICB0aGlzLnNjb3JlID0gMCAgICAgIC8vICDlvpfliIZcclxuICAgICAgICB0aGlzLmV2ZW50cyA9IFtdICAgIC8vICDkuovku7bpmJ/liJfvvIzpgb/lhY3njqnlrrbmiYvpgJ/ov4flv6vvvIzom4fnmq7msqHnp7vliqjlsLHooqvkuIvkuIDkuKrliqjkvZzopobnm5ZcclxuICAgICAgICB0aGlzLmNyZWF0ZVN0YXRpY0NhbnZhcygpXHJcbiAgICAgICAgdGhpcy5jcmVhdGVTdGF0KClcclxuICAgICAgICB0aGlzLnNldFNpemUoKVxyXG4gICAgICAgIHRoaXMuZ2V0TWFwcygpXHJcbiAgICAgICAgdGhpcy5iaW5kRXZlbnQoKVxyXG4gICAgICAgIHRoaXMucmVuZGVyKClcclxuICAgIH1cclxuICAgIC8vICDnlJ/miJDkuIDkuKrpnZnmgIHnmoRjYW52YXPjgJDmlL7og4zmma/vvIzmoLzlrZDnrYnnmoTpnZnmgIHnlLvluIPjgJFcclxuICAgIGNyZWF0ZVN0YXRpY0NhbnZhcygpIHtcclxuICAgICAgICB0aGlzLnN0YXRpY19jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKVxyXG4gICAgICAgIHRoaXMuc3RhdGljX2N4dCA9IHRoaXMuc3RhdGljX2NhbnZhcy5nZXRDb250ZXh0KCcyZCcpXHJcbiAgICAgICAgdGhpcy5jYW52YXMuc3R5bGUuY3NzVGV4dCA9IGBcclxuICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xyXG4gICAgICAgICAgICB6LWluZGV4OiAxO1xyXG4gICAgICAgIGBcclxuICAgICAgICB0aGlzLnN0YXRpY19jYW52YXMuc3R5bGUuY3NzVGV4dCA9IGBcclxuICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xyXG4gICAgICAgICAgICBsZWZ0OiAwO1xyXG4gICAgICAgICAgICB0b3A6IDA7XHJcbiAgICAgICAgYFxyXG4gICAgICAgIHRoaXMucGFyZW50LnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJ1xyXG4gICAgICAgIHRoaXMucGFyZW50LmFwcGVuZENoaWxkKHRoaXMuc3RhdGljX2NhbnZhcylcclxuICAgIH1cclxuICAgIC8vICDnlJ/miJDlj7PkuIrop5LmlbDmja7lsZXnpLog77yI55uR5ZCs6YCf5bqm77yM6ZW/5bqm562J77yJXHJcbiAgICBjcmVhdGVTdGF0KCkge1xyXG4gICAgICAgIHRoaXMuc3RhdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0RJVicpXHJcbiAgICAgICAgdGhpcy5zcGVlZEJsb2NrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnRElWJylcclxuICAgICAgICB0aGlzLnNjb3JlQmxvY2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdESVYnKVxyXG4gICAgICAgIHRoaXMuc3RhdC5zdHlsZS5jc3NUZXh0ID0gYFxyXG4gICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICAgICAgICAgIHJpZ2h0OiAwO1xyXG4gICAgICAgICAgICBib3R0b206IDEwMCU7XHJcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTZweDtcclxuICAgICAgICBgXHJcbiAgICAgICAgdGhpcy5vYnNlcnZlcignc3BlZWQnLCAodmFsKSA9PiB0aGlzLnNwZWVkQmxvY2sudGV4dENvbnRlbnQgPSBg6YCf5bqm77yaJHt2YWx9bXMv5qC8YClcclxuICAgICAgICB0aGlzLm9ic2VydmVyKCdzY29yZScsICh2YWwpID0+IHRoaXMuc2NvcmVCbG9jay50ZXh0Q29udGVudCA9IGDlvpfliIbvvJoke3ZhbH1gKVxyXG4gICAgICAgIHRoaXMuc3RhdC5hcHBlbmRDaGlsZCh0aGlzLnNwZWVkQmxvY2spXHJcbiAgICAgICAgdGhpcy5zdGF0LmFwcGVuZENoaWxkKHRoaXMuc2NvcmVCbG9jaylcclxuICAgICAgICB0aGlzLnBhcmVudC5hcHBlbmRDaGlsZCh0aGlzLnN0YXQpXHJcbiAgICB9XHJcbiAgICAvLyAg55uR5ZCs5pWw5o2u5Y+Y5YyWXHJcbiAgICBvYnNlcnZlcihrZXksIGNiKSB7XHJcbiAgICAgICAgbGV0IHZhbCA9IHRoaXNba2V5XVxyXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBrZXksIHtcclxuICAgICAgICAgICAgZ2V0OiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNldDogKG5ld1ZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjYihuZXdWYWx1ZSlcclxuICAgICAgICAgICAgICAgIHZhbCA9IG5ld1ZhbHVlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbiAgICAvLyAg5Yid5aeL5YyW5bC65a+4XHJcbiAgICBzZXRTaXplKCkge1xyXG4gICAgICAgIHRoaXMud2lkdGggPSB0aGlzLmNvbHMgKiB0aGlzLnNpemVcclxuICAgICAgICB0aGlzLmhlaWdodCA9IHRoaXMucm93cyAqIHRoaXMuc2l6ZVxyXG4gICAgICAgIHRoaXMuY2FudmFzLndpZHRoID0gdGhpcy53aWR0aFxyXG4gICAgICAgIHRoaXMuY2FudmFzLmhlaWdodCA9IHRoaXMuaGVpZ2h0XHJcbiAgICAgICAgdGhpcy5zdGF0aWNfY2FudmFzLndpZHRoID0gdGhpcy53aWR0aFxyXG4gICAgICAgIHRoaXMuc3RhdGljX2NhbnZhcy5oZWlnaHQgPSB0aGlzLmhlaWdodFxyXG4gICAgfVxyXG4gICAgLy8gIOiOt+W+l+aWueWQkeWvueW6lOeahOaVsOWAvCAo5oiR5Zyo5L2g5LiL6Z2i77yM6YKj5oiR55qE57Si5byV5bCx5q+U5L2g5aSadGhpcy5jb2xz77yM5Zyo5L2g5Y+z6L656YKj5bCx5pivMSlcclxuICAgIGdldE1hcHMoKSB7XHJcbiAgICAgICAgdGhpcy5tYXBzID0ge1xyXG4gICAgICAgICAgICB0b3A6IC10aGlzLmNvbHMsXHJcbiAgICAgICAgICAgIGJvdHRvbTogdGhpcy5jb2xzLFxyXG4gICAgICAgICAgICBsZWZ0OiAtMSxcclxuICAgICAgICAgICAgcmlnaHQ6IDFcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyAg57uR5a6a5LqL5Lu2XHJcbiAgICBiaW5kRXZlbnQoKSB7XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuZ2V0S2V5Q29kZS5iaW5kKHRoaXMpKVxyXG4gICAgfVxyXG4gICAgLy8gIOiOt+W+l+mUruebmOaTjeS9nFxyXG4gICAgZ2V0S2V5Q29kZShlKSB7XHJcbiAgICAgICAgc3dpdGNoIChlLmtleUNvZGUpIHtcclxuICAgICAgICAgICAgY2FzZSA4NzpcclxuICAgICAgICAgICAgY2FzZSAzODpcclxuICAgICAgICAgICAgICAgIHRoaXMuZXZlbnRzLnB1c2goKCkgPT4gdGhpcy5zZXREaXIoJ3RvcCcpKVxyXG4gICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgY2FzZSA2NTpcclxuICAgICAgICAgICAgY2FzZSAzNzpcclxuICAgICAgICAgICAgICAgIHRoaXMuZXZlbnRzLnB1c2goKCkgPT4gdGhpcy5zZXREaXIoJ2xlZnQnKSlcclxuICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgIGNhc2UgMzk6XHJcbiAgICAgICAgICAgIGNhc2UgNjg6XHJcbiAgICAgICAgICAgICAgICB0aGlzLmV2ZW50cy5wdXNoKCgpID0+IHRoaXMuc2V0RGlyKCdyaWdodCcpKVxyXG4gICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgY2FzZSA0MDpcclxuICAgICAgICAgICAgY2FzZSA4MzpcclxuICAgICAgICAgICAgICAgIHRoaXMuZXZlbnRzLnB1c2goKCkgPT4gdGhpcy5zZXREaXIoJ2JvdHRvbScpKVxyXG4gICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgY2FzZSAzMjpcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnN3aXRjaEdhbWVTdGF0dXMoKVxyXG4gICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vICDmiafooYzpmJ/liJfkuK3nmoTkuovku7ZcclxuICAgIGV4ZWNRdWV1ZSgpIHtcclxuICAgICAgICBpZiAodGhpcy5ldmVudHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICh0aGlzLmV2ZW50cy5zaGlmdCgpKSgpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gIOa4uOaIj+W8gOWni1xyXG4gICAgc3RhcnQobW9kZSkge1xyXG4gICAgICAgIE9iamVjdC5hc3NpZ24odGhpcywgX2luaXQsIF9tb2RlW21vZGVdKVxyXG4gICAgICAgIHRoaXMuZGlyID0gJ3JpZ2h0J1xyXG4gICAgICAgIHRoaXMuYmFycmllciA9IFtdXHJcbiAgICAgICAgdGhpcy5ldmVudHMgPSBbXVxyXG4gICAgICAgIG1vZGUgPT09ICdlbHVkZScgJiYgdGhpcy5jcmVhdGVCYXJyaWVyKClcclxuICAgICAgICB0aGlzLnNjb3JlID0gbW9kZSA9PT0gJ2VsdWRlJyA/ICgodGhpcy5jdXN0b20gLSAxKSAqIHRoaXMubW9kZS5lYXRBcHBsZS5wYXNzICogdGhpcy5hcHBsZVNjb3JlKSA6IDBcclxuICAgICAgICB0aGlzLnN0YXJ0Q2IgJiYgdGhpcy5zdGFydENiKClcclxuICAgICAgICB0aGlzLmdhbWVSZXN0KClcclxuICAgICAgICB0aGlzLmdhbWVUaW1lID0gMFxyXG4gICAgICAgIHRoaXMuZ2FtZVN0YXJ0KClcclxuICAgIH1cclxuICAgIC8vICDnlJ/miJDpmpznoo3niakg77yI5YWz5Y2h5Yaz5a6a5pWw6YeP77yJXHJcbiAgICBjcmVhdGVCYXJyaWVyKCkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgKHRoaXMuY3VzdG9tICogdGhpcy5jYXJkaW5hbE51bWJlcik7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgYmFycmllciA9IHRoaXMuYm9keVswXVxyXG4gICAgICAgICAgICAvLyAg6ZqP5py65Yiw6Z2e56ys5LiA6KGM55qE5Zyw5pa5XHJcbiAgICAgICAgICAgIHdoaWxlIChiYXJyaWVyIDw9IHRoaXMuY29scykge1xyXG4gICAgICAgICAgICAgICAgYmFycmllciA9IHRoaXMuZ2V0UmFuZG9tKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmJhcnJpZXIucHVzaChiYXJyaWVyKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vICDmuLjmiI/ph43nva5cclxuICAgIGdhbWVSZXN0KCkge1xyXG4gICAgICAgIHRoaXMuc2V0U2l6ZSgpXHJcbiAgICAgICAgdGhpcy5nZXRNYXBzKClcclxuICAgICAgICB0aGlzLnJlbmRlckJnKClcclxuICAgICAgICB0aGlzLnJlbmRlckJhcnJpZXIoKVxyXG4gICAgICAgIHRoaXMucmVuZGVyR3JpZCgpXHJcbiAgICAgICAgdGhpcy5hZGRBcHBsZSgpXHJcbiAgICB9XHJcbiAgICAvLyAg5byA5aeL5riy5p+TXHJcbiAgICBnYW1lU3RhcnQoKSB7XHJcbiAgICAgICAgdGhpcy5pc0FuaW1hdGUgPSB0cnVlXHJcblxyXG4gICAgICAgIGNvbnN0IHRpbWVyID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc0FuaW1hdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVRpbWUgKz0gdGhpcy5zcGVlZFxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubW9kZS5zcGVlZFVwICYmIHRoaXMuZ2FtZVRpbWUgPj0gdGhpcy5tb2RlLnNwZWVkVXAudGltZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVRpbWUgPSAwXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGVlZCAtPSB0aGlzLm1vZGUuc3BlZWRVcC5jb3VudFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5jeHQuY2xlYXJSZWN0KDAsIDAsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KVxyXG4gICAgICAgICAgICAgICAgdGhpcy5leGVjUXVldWUoKVxyXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGUoKVxyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIoKVxyXG4gICAgICAgICAgICAgICAgdGltZXIoKVxyXG4gICAgICAgICAgICB9LCB0aGlzLnNwZWVkKVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aW1lcigpXHJcbiAgICB9XHJcbiAgICAvLyAg5pqC5YGc5ri45oiPXHJcbiAgICBzdG9wKCkge1xyXG4gICAgICAgIHRoaXMuc3RvcENiICYmIHRoaXMuc3RvcENiKClcclxuICAgICAgICB0aGlzLmlzQW5pbWF0ZSA9IGZhbHNlXHJcbiAgICB9XHJcbiAgICAvLyAg5pqC5YGcL+W8gOWni+a4uOaIj1xyXG4gICAgc3dpdGNoR2FtZVN0YXR1cygpIHtcclxuICAgICAgICBpZiAoIXRoaXMuaXNQbGF5aW5nKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuaXNBbmltYXRlKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGF1c2VCZWdpbiAmJiB0aGlzLnBhdXNlQmVnaW4oKVxyXG4gICAgICAgICAgICB0aGlzLmlzQW5pbWF0ZSA9IGZhbHNlXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnBhdXNlRW5kICYmIHRoaXMucGF1c2VFbmQoKVxyXG4gICAgICAgICAgICB0aGlzLmdhbWVTdGFydCgpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gIOa4uOaIj+e7k+adn1xyXG4gICAgZ2FtZW92ZXIoKSB7XHJcbiAgICAgICAgdGhpcy5zdG9wKClcclxuICAgICAgICB0aGlzLnJlbmRlcigpXHJcbiAgICB9XHJcbiAgICAvLyAg5riy5p+TXHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJTbmFrZSgpXHJcbiAgICAgICAgdGhpcy5yZW5kZXJBcHBsZSgpXHJcbiAgICB9XHJcbiAgICAvLyAg55S76Zqc56KN54mpXHJcbiAgICByZW5kZXJCYXJyaWVyKCkge1xyXG4gICAgICAgIHRoaXMuc3RhdGljX2N4dC5maWxsU3R5bGUgPSB0aGlzLmJhcnJpZXJDb2xvclxyXG4gICAgICAgIEFycmF5LmZyb20odGhpcy5iYXJyaWVyLCAocG9zLCBpKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCB7IHgsIHkgfSA9IHRoaXMuZ2V0Q29vcmQocG9zKVxyXG4gICAgICAgICAgICB0aGlzLnN0YXRpY19jeHQuZmlsbFJlY3QoeCAqIHRoaXMuc2l6ZSwgeSAqIHRoaXMuc2l6ZSwgdGhpcy5zaXplLCB0aGlzLnNpemUpXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuICAgIC8vICDnlLvmnaHom4dcclxuICAgIHJlbmRlclNuYWtlKCkge1xyXG4gICAgICAgIHRoaXMuY3h0LmZpbGxTdHlsZSA9IHRoaXMuc25ha2VDb2xvclxyXG4gICAgICAgIEFycmF5LmZyb20odGhpcy5ib2R5LCAocG9zLCBpKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCB7IHgsIHkgfSA9IHRoaXMuZ2V0Q29vcmQocG9zKVxyXG4gICAgICAgICAgICB0aGlzLmN4dC5maWxsUmVjdCh4ICogdGhpcy5zaXplLCB5ICogdGhpcy5zaXplLCB0aGlzLnNpemUsIHRoaXMuc2l6ZSlcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG4gICAgLy8gIOeUu+agvOWtkFxyXG4gICAgcmVuZGVyR3JpZCgpIHtcclxuICAgICAgICB0aGlzLnN0YXRpY19jeHQuc3Ryb2tlU3R5bGUgPSAnI2NjYydcclxuICAgICAgICB0aGlzLnN0YXRpY19jeHQubGluZVdpZHRoID0gMVxyXG4gICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgdGhpcy5yb3dzOyB4KyspIHtcclxuICAgICAgICAgICAgdGhpcy5zdGF0aWNfY3h0Lm1vdmVUbyh4ICogdGhpcy5zaXplLCAwKVxyXG4gICAgICAgICAgICB0aGlzLnN0YXRpY19jeHQubGluZVRvKHggKiB0aGlzLnNpemUsIHRoaXMucm93cyAqIHRoaXMuc2l6ZSlcclxuICAgICAgICAgICAgdGhpcy5zdGF0aWNfY3h0LnN0cm9rZSgpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAobGV0IHkgPSAwOyB5IDwgdGhpcy5jb2xzOyB5KyspIHtcclxuICAgICAgICAgICAgdGhpcy5zdGF0aWNfY3h0Lm1vdmVUbygwLCB5ICogdGhpcy5zaXplKVxyXG4gICAgICAgICAgICB0aGlzLnN0YXRpY19jeHQubGluZVRvKHRoaXMuY29scyAqIHRoaXMuc2l6ZSwgeSAqIHRoaXMuc2l6ZSlcclxuICAgICAgICAgICAgdGhpcy5zdGF0aWNfY3h0LnN0cm9rZSgpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gIOeUu+iDjOaZr1xyXG4gICAgcmVuZGVyQmcoKSB7XHJcbiAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCB0aGlzLnJvd3M7IHgrKykge1xyXG4gICAgICAgICAgICBmb3IgKGxldCB5ID0gMDsgeSA8IHRoaXMuY29sczsgeSsrKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRpY19jeHQuZmlsbFN0eWxlID0gKHggKyB5KSAlIDIgPT09IDAgPyB0aGlzLmJnQ29sb3JbMF0gOiB0aGlzLmJnQ29sb3JbMV1cclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGljX2N4dC5maWxsUmVjdCh4ICogdGhpcy5zaXplLCB5ICogdGhpcy5zaXplLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vICDnlLvkuKroi7nmnpxcclxuICAgIHJlbmRlckFwcGxlKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmFwcGxlKSB7XHJcbiAgICAgICAgICAgIGxldCB7IHgsIHkgfSA9IHRoaXMuZ2V0Q29vcmQodGhpcy5hcHBsZSlcclxuICAgICAgICAgICAgdGhpcy5jeHQuZmlsbFN0eWxlID0gdGhpcy5hcHBsZUNvbG9yXHJcblxyXG4gICAgICAgICAgICB0aGlzLmN4dC5iZWdpblBhdGgoKVxyXG4gICAgICAgICAgICB0aGlzLmN4dC5hcmMoeCAqIHRoaXMuc2l6ZSArIHRoaXMuc2l6ZSAvIDIsIHkgKiB0aGlzLnNpemUgKyB0aGlzLnNpemUgLyAyLCB0aGlzLnNpemUgLyAyLCAwLCAyICogTWF0aC5QSSwgdHJ1ZSlcclxuICAgICAgICAgICAgdGhpcy5jeHQuY2xvc2VQYXRoKClcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY3h0LmZpbGwoKVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5hZGRBcHBsZSgpXHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyQXBwbGUoKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vICDmoLnmja7ntKLlvJXojrflvpflnZDmoIdcclxuICAgIGdldENvb3JkKGluZGV4KSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgeDogaW5kZXggJSB0aGlzLmNvbHMsXHJcbiAgICAgICAgICAgIHk6IH5+KGluZGV4IC8gdGhpcy5jb2xzKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vICDorr7nva7mlrnlkJFcclxuICAgIHNldERpcihkaXIpIHtcclxuICAgICAgICAvLyAg5ZCM5pa55ZCR5oiW6ICF55u45Y+N5pa55ZCR5bCx566X5LqGXHJcbiAgICAgICAgaWYgKGRpciA9PT0gdGhpcy5kaXIgfHwgZGlyID09PSBkaXJNYXBbdGhpcy5kaXJdKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmRpciA9IGRpclxyXG4gICAgfVxyXG4gICAgLy8gIOaYr+S4jeaYr+WHuueVjOS6hlxyXG4gICAgaXNGYWlsZWQoaW5kZXgpIHtcclxuICAgICAgICBsZXQgeyB4LCB5IH0gPSB0aGlzLmdldENvb3JkKGluZGV4KVxyXG4gICAgICAgIC8vICDpnaDlt6bovrnkuJTlt6bovazlsLFnYW1lb3ZlcuS6hu+8jOS4i+mdouS4ieS4quWQjOeQhlxyXG4gICAgICAgIGlmICh4ID09PSAwICYmIHRoaXMuZGlyID09PSAnbGVmdCcpIHtcclxuICAgICAgICAgICAgdGhpcy5nYW1lb3ZlcigpXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh4ID09PSAodGhpcy5jb2xzIC0gMSkgJiYgdGhpcy5kaXIgPT09ICdyaWdodCcpIHtcclxuICAgICAgICAgICAgdGhpcy5nYW1lb3ZlcigpXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh5ID09PSAwICYmIHRoaXMuZGlyID09PSAndG9wJykge1xyXG4gICAgICAgICAgICB0aGlzLmdhbWVvdmVyKClcclxuICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHkgPT09ICh0aGlzLnJvd3MgLSAxKSAmJiB0aGlzLmRpciA9PT0gJ2JvdHRvbScpIHtcclxuICAgICAgICAgICAgdGhpcy5nYW1lb3ZlcigpXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gIOS4pOeCueehruWumuaWueWQkSDjgJDmoLnmja7lt67lgLzlr7nnhadtYXBz5a+56LGh5b6X5Yiw5pa55ZCR44CRXHJcbiAgICBnZXRTZWxmRGlyKHBvczEsIHBvczIpIHtcclxuICAgICAgICBsZXQgZCA9IHBvczIgLSBwb3MxXHJcbiAgICAgICAgZm9yIChsZXQgZGlyIGluIHRoaXMubWFwcykge1xyXG4gICAgICAgICAgICBpZiAoZCA9PT0gdGhpcy5tYXBzW2Rpcl0pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkaXJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vICDmuLLmn5Pmm7TmlrBcclxuICAgIHVwZGF0ZSgpIHtcclxuICAgICAgICBsZXQgeyBib2R5LCBiYXJyaWVyIH0gPSB0aGlzXHJcbiAgICAgICAgLy8gIOWktOmDqFxyXG4gICAgICAgIGxldCBoZWFkID0gYm9keVtib2R5Lmxlbmd0aCAtIDFdXHJcbiAgICAgICAgLy8gIOWwvumDqFxyXG4gICAgICAgIGxldCB0YWlsID0gYm9keVswXVxyXG4gICAgICAgIC8vICDlpLTpg6jnmoTkuIvkuIDkuKrmlrnkvY1cclxuICAgICAgICBsZXQgbmV4dEhlYWQgPSBoZWFkICsgdGhpcy5tYXBzW3RoaXMuZGlyXVxyXG5cclxuICAgICAgICAvLyAg5aS06YOo6KaB6LaF5Ye66L6555WMIOaIluiAhSDmkp7liLDoh6rlt7Eg5oiW6ICF5pKe5Yiw6Zqc56KN54mpXHJcbiAgICAgICAgaWYgKHRoaXMuaXNGYWlsZWQoaGVhZCkgfHwgYm9keS5pbmRleE9mKG5leHRIZWFkKSA+IC0xIHx8IGJhcnJpZXIuaW5kZXhPZihuZXh0SGVhZCkgPiAtMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nYW1lb3ZlcigpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyAg6Zmk5LqG5aS06YOo55qE5YW25LuWIOi6q+S9k+WdlyDmjIkg57Sn5o6l552A55qE5LiL5LiA5Z2X6Lqr5L2T5Z2XIOenu+WKqFxyXG4gICAgICAgIHRoaXMuYm9keSA9IEFycmF5LmZyb20odGhpcy5ib2R5LCAocG9zLCBpKSA9PiBpID09PSBib2R5Lmxlbmd0aCAtIDEgPyBuZXh0SGVhZCA6IChwb3MgKyB0aGlzLm1hcHNbdGhpcy5nZXRTZWxmRGlyKHBvcywgYm9keVtpICsgMV0pXSkpXHJcblxyXG4gICAgICAgIC8vICDmmK/kuI3mmK/lkIPliLDoi7nmnpzlkYBcclxuICAgICAgICBpZiAobmV4dEhlYWQgPT09IHRoaXMuYXBwbGUpIHtcclxuICAgICAgICAgICAgdGhpcy5hcHBsZSA9IG51bGxcclxuICAgICAgICAgICAgdGhpcy5zY29yZSArPSB0aGlzLmFwcGxlU2NvcmUgLy8gIOWIhuaVsOWPoOWKoFxyXG4gICAgICAgICAgICB0aGlzLmJvZHkudW5zaGlmdCh0YWlsKSAgICAgICAvLyAg6Lqr5L2TICsgMSDlsL7pg6jmt7vliqBcclxuXHJcbiAgICAgICAgICAgIC8vICDmoLnmja7muLjmiI/mqKHlvI/lgZrlh7rkuI3lkIzlpITnkIZcclxuICAgICAgICAgICAgaWYgKHRoaXMubW9kZS5lYXRBcHBsZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlLmVhdEFwcGxlLmN1cisrXHJcblxyXG4gICAgICAgICAgICAgICAgLy8gIOWQg+Wkn+S6hlxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubW9kZS5lYXRBcHBsZS5jdXIgPT09IHRoaXMubW9kZS5lYXRBcHBsZS5wYXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tb2RlLmVhdEFwcGxlLmN1ciA9IDBcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gIOi6sumBv+aooeW8j1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm1vZGUuZWF0QXBwbGUuY3VzdG9tKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VzdG9tKytcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lb3ZlcigpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gYWxlcnQoJ+S9oOmAmuWFs+S6hu+8jOe7p+e7reeOqei6sumBv+aooeW8j+i/m+ihjOS4i+S4gOWFsycpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gIOmAmuWFs+aooeW8j1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3BlZWQgLT0gdGhpcy5tb2RlLmVhdEFwcGxlLmNvdW50XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyAg6ZqP5py65LiA5Liq5pWw5a2XXHJcbiAgICBnZXRSYW5kb20oKSB7XHJcbiAgICAgICAgcmV0dXJuIH5+KE1hdGgucmFuZG9tKCkgKiB0aGlzLmNvbHMgKiB0aGlzLnJvd3MpXHJcbiAgICB9XHJcbiAgICAvLyAg5Yqg5Liq5p6c5a2QXHJcbiAgICBhZGRBcHBsZSgpIHtcclxuICAgICAgICBsZXQgYXBwbGUgPSB0aGlzLmdldFJhbmRvbSgpXHJcbiAgICAgICAgLy8gIOmaj+acuuWIsOmdnui6q+S9k29y6Zqc56KN54mp5L2N572u55qE5Zyw5pa55re75Yqg5Liq5p6c5a2QXHJcbiAgICAgICAgd2hpbGUgKHRoaXMuYm9keS5pbmRleE9mKGFwcGxlKSA+IC0xIHx8IHRoaXMuYmFycmllci5pbmRleE9mKGFwcGxlKSA+IC0xKSB7XHJcbiAgICAgICAgICAgIGFwcGxlID0gdGhpcy5nZXRSYW5kb20oKVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmFwcGxlID0gYXBwbGVcclxuICAgIH1cclxufSJdfQ==
